//@flow
const DepthComplexity = require('./depthComplexity');
const CostComplexityOptions = require('./costLimit');
const { GraphQLError } = require('graphql');

import type { ValidationContext } from 'graphql';
import type { costComplexityOptions } from './costLimit';
import type { DepthComplexityOptions } from './depthComplexity';

const costLimit = (rule: costComplexityOptions): Function => {
  if (rule.costLimit <= 0) throw new GraphQLError('Cost limit must be greater than 0');

  return (context: ValidationContext): CostComplexityOptions => {
    return new CostComplexityOptions((context: ValidationContext), (rule: costComplexityOptions));
  };
};

const depthComplexity = (rule: DepthComplexityOptions): Function => {
  if (rule.depthLimit <= 0) throw new GraphQLError('Depth limit must be greater than 0');

  return (context: ValidationContext): DepthComplexity => {
    return new DepthComplexity((context: ValidationContext), (rule: DepthComplexityOptions));
  };
};

module.exports = {
  costLimit,
  depthComplexity
}